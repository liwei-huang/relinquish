# Learn Elixir

å­¦ä¹  Elixir è¯­è¨€ã€‚

ç¼–å†™æ–‡æ¡£æ—¶ï¼š

- Elixir 1.14.4 (compiled with Erlang/OTP 25)
- Windows 10

## å‘½ä»¤

| å‘½ä»¤                     | è¯´æ˜                         |
| ------------------------ | ---------------------------- |
| `mix new <project_name>` | åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®               |
| `mix run`                | è¿è¡Œé¡¹ç›®                     |
| `mix clean`              | æ¸…é™¤ç”Ÿæˆçš„åº”ç”¨æ–‡ä»¶           |
| `mix help`               | è·å–å¸®åŠ©                     |
| `elixir <file>.ex`       | è¿è¡Œæ–‡ä»¶                     |
| `elixir --help`          | è·å–å¸®åŠ©                     |
| `elixir --version`       | æ˜¾ç¤ºç‰ˆæœ¬                     |
| `iex.bat`                | è¿›å…¥äº¤äº’æ¨¡å¼                 |
| `iex.bat --werl`         | Windows å¹³å°ä¸‹æ›´å¥½çš„äº¤äº’æ¨¡å¼ |

## é¢„å¤‡çŸ¥è¯†

### ç¼–å†™é£æ ¼

- å•ä½ç¼©è¿›æ˜¯ 2 ä¸ªç©ºæ ¼
- ä¸ç”¨åˆ†å·ï¼ˆ`;`ï¼‰å’ŒèŠ±æ‹¬å·ï¼ˆ`{}`ï¼‰
- ä½¿ç”¨ç¼©è¿›åˆ’åˆ†ä»£ç åŒºåŸŸ

### ç»‘å®šå˜é‡

ç»‘å®šå˜é‡ä½¿ç”¨ `variable = value` çš„å½¢å¼ï¼Œä¸éœ€è¦è¯¸æŒ `let` è¿™æ ·çš„å…³é”®å­—ã€‚

> æ³¨æ„ï¼Œä¸Šé¢çš„ `=` æ˜¯åŒ¹é…æ“ä½œç¬¦ï¼Œä¸å®Œå…¨ç­‰äºèµ‹å€¼çš„è¯­ä¹‰ã€‚

### æ‰“å°

- `IO.puts/2` è¾“å‡ºå†…å®¹åˆ°**è£…ç½®**ï¼ˆé»˜è®¤æ˜¯æ ‡å‡†è¾“å‡ºï¼‰ï¼Œå¸¦æœ‰æ¢è¡Œ
- `IO.inspect/2` æ£€æŸ¥å€¼ï¼Œå¹¶å†™åˆ°ï¼ˆè¾“å‡ºæ˜¾ç¤ºï¼‰è£…ç½®ï¼Œå¸¦æœ‰æ¢è¡Œ

> æç¤ºï¼Œ`IO.inspect/2` é€‚åˆæ˜¾ç¤ºå„ç§æ•°æ®ï¼Œèƒ½å¤Ÿæ­£ç¡®æ‰“å°åˆ—è¡¨ç­‰æ•°æ®ï¼Œè€Œ `IO.puts/2` æ›´é€‚åˆæ˜¾ç¤ºå­—ç¬¦ä¸²æˆ–è€…**å­—ç¬¦åˆ—è¡¨**ã€‚

### æ³¨é‡Š

è¡Œæ³¨é‡Šä½¿ç”¨ `#` ãªã€‚

### è¯†åˆ«å‡½æ•°

å‡½æ•°ä»¥åå­—å’Œè®¡é‡è¡¨ç¤ºï¼Œå³ `func_name/arity` è¢¤

- `func_name` æ˜¯å‡½æ•°çš„åå­—
- `arity` æ˜¯å‚æ•°çš„ä¸ªæ•°

> æ³¨æ„ï¼Œè¿™æ˜¯å‡½æ•°çš„è¯†åˆ«è¡¨ç¤ºæ³•ï¼Œè°ƒç”¨å‡½æ•°ä»ç„¶ä½¿ç”¨ `func_name()` çš„å½¢å¼ã€‚

### äº¤äº’æ¨¡å¼

- ä½¿ç”¨ `iex` æˆ– `iex.bat` æˆ– `iex.bat --werl` è¿›å…¥
- äº¤äº’æ¨¡å¼ä¸‹
  - è¾“å…¥ `h` æ˜¾ç¤º `IEx.Helpers` çš„æ–‡æ¡£
  - è¾“å…¥ `h <func_name/arity>` æ˜¾ç¤ºå‡½æ•°çš„æ–‡æ¡£
  - è¾“å…¥ `i <value>` æ˜¾ç¤ºå…³äºè¿™ä¸ªå€¼çš„ä¿¡æ¯

> æç¤ºï¼ŒWinodws å¹³å°æœ€å¥½ä½¿ç”¨ `iex.bat --werl` è¿›å…¥äº¤äº’æ¨¡å¼ï¼Œæº˜é¿å…ä¸€äº›é—®é¢˜ã€‚

## åŸºæœ¬ç±»å‹

| ç±»å‹      | è¯´æ˜   |
| --------- | ------ |
| `integer` | æ•´æ•°   |
| `float`   | æµ®ç‚¹æ•° |
| `boolean` | å¸ƒå°”å€¼ |
| `atom`    | åŸå­   |
| `string`  | å­—ç¬¦ä¸² |
| `list`    | åˆ—è¡¨   |
| `tuple`   | å…ƒç»„   |

```elixir
# integer
IO.puts(1)
# float
IO.puts(2.0)
# boolean
IO.puts(true)
# atom
IO.puts(:symbol)
# string
IO.puts("elixir")
# list
[1, 2, 3]
# tuple
{1, 2, 3}
```

### æ•´æ•°å’Œæµ®ç‚¹æ•°

æ•´æ•°å’Œæµ®ç‚¹æ•°çš„ä¸€äº›æ“ä½œç¬¦ï¼š`+` æ½¡ `-` æ½¡ `*` æ½¡ `/`ï¼Œæ²¡æœ‰ `%` ãªã€‚

- é™¤å· `/` æ€»æ˜¯è¿”å›æµ®ç‚¹æ•°ï¼Œå¦‚æœè¦å¾—åˆ°æ•´æ•°ï¼Œä½¿ç”¨ `div/2`
- å¦‚æœè¦æ±‚ä½™ï¼Œä½¿ç”¨ `rem/2`
- æ•´æ•°ä¸æµ®ç‚¹æ•°è¿ç®—ï¼Œç»“æœæ˜¯æµ®ç‚¹æ•°
- æµ®ç‚¹æ•°æ˜¯ 64 ä½**åŒç²¾åº¦**çš„
- æµ®ç‚¹æ•°æ”¯æŒ `e` ç§‘å­¦è¡¨ç¤ºæ³•
- æ•´æ•°å’Œæµ®ç‚¹æ•°éƒ½æ”¯æŒä¸‹åˆ’çº¿ `_` è¡¨ç¤ºæ³•

```elixir
IO.puts(1 + 2)
IO.puts(1 - 2)
IO.puts(2 * 3)
# 5.0
IO.puts(10 / 2)

# 5
IO.puts(div(10, 2))
# 1
IO.puts(rem(10, 3))
```

æ•´æ•°çš„ä¸åŒè¿›åˆ¶è¡¨ç¤ºï¼š

```elixir
IO.puts(28)
IO.puts(0b0001_1100)
IO.puts(0o34)
IO.puts(0x1C)
```

æ¯”è¾ƒæ“ä½œç¬¦ï¼š

```txt
<, >, <=, >=, ==, ===, !=, !==
```

éœ‘ `===` æˆ– `!==` æ˜¯æ›´ä¸¥æ ¼çš„ç›¸ç­‰æ€§æ¯”è¾ƒï¼š

```elixir
# true
IO.puts(1 == 1.0)
# false
IO.puts(1 === 1.0)
```

### å¸ƒå°”å€¼

å¸ƒå°”å€¼ç›¸å…³çš„æ“ä½œç¬¦ï¼š

- `or` æ½¡ `and` å’Œ `not`
  - æ“ä½œç¬¦å·¦è¾¹å¿…é¡»æ˜¯ `boolean` ç±»å‹
  - å­˜åœ¨çŸ­è·¯
- `||` æ½¡ `&&` å’Œ `!`
  - æ“ä½œç¬¦ä¸¤è¾¹å¯ä»¥æ˜¯ä»»ä½•ç±»å‹
  - å­˜åœ¨çŸ­è·¯
  - é™¤äº† `false` å’Œ `nil` è¯„ä¼°ä”º `false`ï¼Œå…¶ä»–å€¼éƒ½è¯„ä¼°ä”º `true`

```elixir
# iex
IO.puts(false or "iex")

# 0
IO.puts(0 || false)
# æ‰“å°ä”ºç©º
IO.puts(nil && true)
```

### åŸå­

- åŸå­æ˜¯ä¸€ç§å¸¸é‡ï¼Œåå­—å°±æ˜¯å®ƒçš„å€¼
- åå­—ä¸€æ ·ï¼ŒåŸå­å°±ç›¸ç­‰
- å¸ƒå°”å€¼ `true` å’Œ `false` ä»¥åŠ `nil` å±äºåŸå­

```elixir
# she
IO.puts(:she)
# ä¸‹é¢éƒ½ä”º `true`
IO.puts(:she == :she)
IO.puts(is_atom(:she))
IO.puts(is_atom(false))
IO.puts(nil == nil)
```

### å­—ç¬¦ä¸²

- **UTF-8** ç¼–ç 
- åŒå¼•å·æ‹¬èµ·æ¥
- æ˜¯ä¸€ç‰‡è¿ç»­çš„å­—èŠ‚åºåˆ—
- å­—ç¬¦ä¸²æ’å€¼ï¼Œä½¿ç”¨ `#{variable}`
- å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä½¿ç”¨ `<>`

ä¸¤ä¸ªå‡½æ•°ï¼š

- `byte_size/1`ï¼Œè¿”å›å­—ç¬¦ä¸²çš„å­—èŠ‚æ•°
- `String.length/1`ï¼Œè¿”å›å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°

```elixir
spring = "hellÃ¶"

# true
IO.puts(is_binary(spring))
# 6
IO.puts(byte_size(spring))
# 5
IO.puts(String.length(spring))

# ä¸‹é¢ä¸¤è¡Œçš„ç»“æœéƒ½ä”º `hellæš, world`
IO.puts("#{spring}, world")
IO.puts(spring <> ", world")
```

> æ³¨æ„ï¼Œä¸€äº›**å­—ç´ **éœ€è¦ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œæ¯”æŒä¸Šé¢çš„ `Ã¶` ãªã€‚

### åˆ—è¡¨

å…³äºåˆ—è¡¨ï¼š

- æ¯ä¸ªå…ƒç´ æŒæœ‰ï¼Œå®ƒè‡ªå·±çš„å€¼ï¼Œå’Œï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼Œç›´åˆ°æœ€åä¸€ä¸ªå…ƒç´ 
- è®¿é—®åˆ—è¡¨é•¿åº¦æ˜¯**çº¿æ€§**æ“ä½œï¼Œéœ€è¦éå†æ•´ä¸ªåˆ—è¡¨ä»¥è®¡ç®—å®ƒçš„å¤§å°
- å…ƒç´ ç±»å‹æº˜ä¸ç›¸åŒ

åˆ—è¡¨ç›¸å…³çš„æ“ä½œï¼ˆä¸‹é¢çš„æ“ä½œéƒ½ä¸ä¼šæ”¹å˜åŸåˆ—è¡¨ï¼Œå› ä¸º Elixir çš„æ•°æ®æ˜¯**ä¸å¯å˜çš„**ï¼‰ï¼š

- `length/1`ï¼Œè·å–åˆ—è¡¨é•¿åº¦ï¼Œå³å…ƒç´ ä¸ªæ•°
- `++/2` å’Œ `--/2`ï¼Œåˆå¹¶æˆ–å‡å»å¦ä¸€ä¸ªåˆ—è¡¨
  - åˆå¹¶æ—¶ï¼Œç›´æ¥å°†å³è¾¹çš„åˆ—è¡¨æ‹¼æ¥åœ¨å·¦è¾¹çš„åˆ—è¡¨åé¢ï¼Œå³ä½¿å®ƒä»¬å«æœ‰ç›¸åŒçš„å…ƒç´ 
  - å‡å»æ—¶ï¼Œå·¦è¾¹çš„åˆ—è¡¨å‡å»å³è¾¹çš„åˆ—è¡¨å«æœ‰çš„å…ƒç´ 
  - é¡ºåºä¸ä¸€æ ·ï¼Œç»“æœä¹Ÿå¯èƒ½ä¸ä¸€æ ·ï¼Œæ€§èƒ½ä¹Ÿå¯èƒ½ä¸ä¸€æ ·
  - æ€§èƒ½å–å†³äºæ“ä½œç¬¦å·¦è¾¹çš„åˆ—è¡¨ï¼Œå·¦è¾¹çš„åˆ—è¡¨è¶Šé•¿ï¼Œæ“ä½œå¼€é”€è¶Šå¤§
- `hd/1` å’Œ `tl/1`ï¼Œè·å–åˆ—è¡¨çš„**å¤´**ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰æˆ–**å°¾**ï¼ˆé™¤ç¬¬ä¸€ä¸ªå…ƒç´ å¤–çš„å…¶ä»–æ‰€æœ‰å…ƒç´ ï¼Œæ‰€ç»„æˆçš„åˆ—è¡¨ï¼‰
  - å®ƒä»¬æ“ä½œç©ºåˆ—è¡¨æ—¶ï¼Œéƒ½ä¼šæŠ¥é”™

```elixir
lsta = [10, 20, 30, "Elixir", false]
lstb = [20, 10, false, -30.3, :cookie]

IO.inspect(length(lsta))
IO.inspect(lsta ++ lstb)
IO.inspect(lstb ++ lsta)
IO.inspect(lsta -- lstb)
IO.inspect(lstb -- lsta)
IO.inspect(hd(lsta))
IO.inspect(tl(lsta))
```

```text
5
[10, 20, 30, "Elixir", false, 20, 10, false, -30.3, :cookie]
[20, 10, false, -30.3, :cookie, 10, 20, 30, "Elixir", false]
[30, "Elixir"]
[-30.3, :cookie]
10
[20, 30, "Elixir", false]
```

å½“åˆ—è¡¨çš„å…ƒç´ æ˜¯ä¸€ç³»åˆ—å¯æ‰“å°çš„ ASCII æ•°å­—æ—¶ï¼Œåˆ—è¡¨ç§°ä”ºå­—ç¬¦åˆ—è¡¨ï¼Œä½¿ç”¨ `IO.puts/2` èµ‰æ‰“å°ã€‚

```elixir
# hello
IO.puts([104, 101, 108, 108, 111])
# 'hello'
IO.inspect([104, 101, 108, 108, 111])
```

> æ³¨æ„ï¼Œå•å¼•å·ç”¨åœ¨å­—ç¬¦åˆ—è¡¨ï¼Œè€ŒåŒå¼•å·ç”¨åœ¨å­—ç¬¦ä¸²ï¼Œ`'hello' == "hello"` ä”º `false` ãªã€‚

### å…ƒç»„

å…³äºå…ƒç»„ï¼š

- åœ¨å†…å­˜ä¸­**è¿ç»­åœ°**å­˜å‚¨å…ƒç´ ï¼Œè®¿é—®å…ƒç´ å’Œè·å–å…ƒç»„é•¿åº¦å¼€é”€å°ï¼Œé€Ÿåº¦å¿«
- æ›´æ–°æˆ–æ·»åŠ å…ƒç´ çš„å¼€é”€å¤§ï¼Œå› ä¸ºéœ€è¦åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å…ƒç»„
- å…ƒç´ ç±»å‹æº˜ä¸ç›¸åŒ
- è¶Šç•Œè®¿é—®å…ƒç»„çš„å…ƒç´ ä¼šæŠ¥é”™

å…ƒç»„ç›¸å…³çš„æ“ä½œï¼š

- `elem/2`ï¼Œè·å–æŒ‡å®šä½ç½®çš„å…ƒç´ 
- `put_elem/3`ï¼Œåœ¨æŒ‡å®šä½ç½®æ’å…¥æ–°çš„å…ƒç´ ï¼ˆæ›¿æ¢åŸæ¥çš„å…ƒç´ ï¼‰
- `tuple_size/1`ï¼Œè·å–å…ƒç»„çš„é•¿åº¦ï¼Œå³å…ƒç´ ä¸ªæ•°

```elixir
tul = {10, false, 20, :cookie}

# 20
IO.inspect(elem(tul, 2))
# {10, "wheel", 20, :cookie}
IO.inspect(put_elem(tul, 1, "wheel"))
# 4
IO.inspect(tuple_size(tul))
```

> æ³¨æ„ï¼Œä¸å…è®¸ `tul.3` è¿™æ ·çš„æ–¹å¼è®¿é—®å…ƒç»„çš„å…ƒç´ ã€‚
> æç¤ºï¼Œåå­—å¸¦æœ‰ `size` çš„å‡½æ•°ï¼Œæ“ä½œçš„æ—¶é—´æ˜¯å¸¸é‡ï¼Œè€Œåå­—å¸¦æœ‰ `length` çš„å‡½æ•°ï¼Œæ“ä½œæ˜¯çº¿æ€§ï¼ˆå†…å®¹è¶Šå¤šï¼Œæ“ä½œå¼€é”€è¶Šå¤§ï¼‰çš„ã€‚ä¾‹æŒï¼š
>
> - `byte_size/1`ï¼Œå­—ç¬¦ä¸²çš„å­—èŠ‚æ•°
> - `tuple_size/1`ï¼Œå…ƒç»„å¤§å°ï¼ˆé•¿åº¦ï¼‰
> - `length/1`ï¼Œåˆ—è¡¨å¤§å°ï¼ˆé•¿åº¦ï¼‰
> - `String.length/1`ï¼Œå­—ç¬¦ä¸²ä¸­çš„å­—ç´ ä¸ªæ•°

### åŒ¿åå‡½æ•°

åŒ¿åå‡½æ•°ï¼š

- ç”± `fn` å’Œ `end` å®šä¹‰
- é€šå¸¸ä¸å†™å‚æ•°çš„ç±»å‹æ³¨è§£
- ä»¥ `func_name.()` å½¢å¼è°ƒç”¨ï¼Œå…¶ä¸­çš„ç‚¹ï¼ˆ`.`ï¼‰ç”¨èµ‰åŒºåˆ†åŒ¿åå‡½æ•°ä¸æ™®é€šå‡½æ•°ï¼ˆå…·åå‡½æ•°ï¼‰
- æº˜**æ•è·**ï¼Œå®šä¹‰åŒ¿åå‡½æ•°æ—¶æ‰€å¤„ä½œç”¨åŸŸå†…çš„ï¼Œå˜é‡ï¼Œå› æ­¤åŒ¿åå‡½æ•°æ˜¯**é—­åŒ…**
- é€šå¸¸ä»¥å‚æ•°è®¡é‡å’Œå‡½æ•° `is_function/2` èµ‰è¯†åˆ«åŒ¿åå‡½æ•°
- åŒ¿åå‡½æ•°æº˜æœ‰å¤šä¸ª**ä»å¥**å’Œ**å®ˆå«**ï¼Œä½†å¿…é¡»ä¿è¯å‚æ•°è®¡é‡ç›¸åŒ

```elixir
add = fn a, b -> a + b end
IO.puts(add.(1, 2))
# `add` å¯”å‡½æ•°
IO.puts(is_function(add))
# `add` å¯”å‡½æ•°ï¼Œä¸”å‚æ•°æ˜¯ 2 ä¸ª
IO.puts(is_function(add, 2))

# åŒ¿åå‡½æ•°çš„ä»å¥å’Œå®ˆå«
my_func = fn
  x, y when y > 0 -> x + y
  x, y -> x * y
end

IO.puts(my_func.(1, 3))
IO.puts(my_func.(10, -5))
```

## æ¨¡å¼åŒ¹é…

éœ‘ `=` æ˜¯åŒ¹é…æ“ä½œç¬¦ï¼Œä¸å®Œå…¨ç­‰äºèµ‹å€¼ã€‚

- `=` çš„å·¦è¾¹ä¸èƒ½æ˜¯å‡½æ•°è°ƒç”¨
- ç”¨äºèµ‹å€¼æ—¶ï¼Œå˜é‡åªèƒ½å†™åœ¨ `=` å·¦è¾¹

```elixir
# éœ‘ `x` ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œç°åœ¨çš„åŒ¹é…æ˜¯å…·æœ‰èµ‹å€¼çš„å«æœ‰ã€‚å› æ­¤ï¼Œèµ‹å€¼æ˜¯åŒ¹é…çš„ä¸€ä¸ªå­ç±»
x = 1
# å› ä¸ºä¸æ˜¯èµ‹å€¼è¯­å¥ï¼Œæ‰€ä»¥æ•°å­— `1` å¯ä»¥å†™åœ¨ `=` å·¦è¾¹
1 = x
```

### åŒ¹é…æ•°æ®ç»“æ„

åŒ¹é…æ•°æ®ç»“æ„ï¼š

- å·¦è¾¹å’Œå³è¾¹ç»“æ„å¿…é¡»ä¸€æ ·ï¼Œå·¦è¾¹ä¸èƒ½åªåŒ¹é…å³è¾¹çš„å±€éƒ¨ï¼Œä¹Ÿä¸èƒ½æ¯”å³è¾¹å¤šå‡ºä¸œè¥¿
- å·¦è¾¹æº˜å›ºå®šæŸä¸ªå€¼ï¼Œé™å®šåŒ¹é…èŒƒå›´
- å˜é‡å‡ºç°å¤šæ¬¡ï¼Œè¡¨ç¤ºå®ƒä»¬çš„å€¼éœ€è¦ç›¸ç­‰ï¼Œæ‰èƒ½åŒ¹é…æˆåŠŸ
- ä½¿ç”¨ `_` è·³è¿‡åŒ¹é…

```elixir
# åŒ¹é…å…ƒç»„
{a, b, c} = {:hello, "world", 402}

# åŒ¹é…åˆ—è¡¨
[d, e, f] = [1, 2, 3]
# head: 4, tail: [5, 6]
[head | tail] = [4, 5, 6]

# å·¦è¾¹å›ºå®šæŸä¸ªå€¼
# åŒ¹é…æˆåŠŸ
{:ok, result1} = {:ok, 13}
# åŒ¹é…å¤±è´¥
# {:ok, result2} = {:error, :oops}

# æˆåŠŸ
{x, x} = {1, 1}
# å¤±è´¥
{y, y} = {1, 2}

# è·³è¿‡åŒ¹é…
[head | _] = [1, 2, 3]
```

> æ³¨æ„ï¼Œ`_` ä¸ä»…æ˜¯è¯­ä¹‰ä¸Šçš„è·³è¿‡åŒ¹é…ï¼Œè€Œä¸”æ˜¯æœ‰ç›¸å…³è§„åˆ™å’ŒåŠŸèƒ½çš„ï¼Œå½“è®¿é—® `_` æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚

### é’‰ä½æ“ä½œç¬¦

å˜é‡æº˜**é‡æ–°ç»‘å®š**ï¼Œå½“éœ€è¦åŒºåˆ†å˜é‡é‡æ–°ç»‘å®šä¸æ¨¡å¼åŒ¹é…æ—¶ï¼Œä½¿ç”¨é’‰ä½æ“ä½œç¬¦ `^`ï¼Œå†™åœ¨å˜é‡åå‰é¢ã€‚

```elixir
x = 2
IO.puts(x)
# å˜é‡é‡æ–°ç»‘å®š
x = 3
IO.puts(x)

y = 4
# æ¨¡å¼åŒ¹é…ï¼ŒåŒ¹é…å¤±è´¥
# ^y = 5
IO.puts(y)

a = 0
{a, b} = {1, 2}
# [1, 2]
IO.inspect([a, b])

c = 0
# {^c, d} = {1, 2}
# åŒ¹é…å¤±è´¥
# IO.inspect([c, d])
```

## æµç¨‹æ§åˆ¶

### case

éœ‘ `case` åŒ¹é…ï¼š

- åº”è¯¥è¦†ç›–åˆ°æ‰€æœ‰å¯èƒ½çš„æƒ…å†µï¼Œæ²¡æœ‰ä»»ä½•ä¸€ä¸ª**ä»å¥**ï¼ˆåŒ¹é…è‡‚ï¼‰åŒ¹é…æ—¶ï¼Œä¼šæŠ¥é”™
- ç‰¹æ€§
  - è·³è¿‡æˆ–å…œåº•ï¼Œç”¨ `_`
  - è§£æ„å‡ºå€¼å¹¶ç»‘å®šåˆ°å˜é‡
  - ä¸å…¶ä»–å˜é‡åŒ¹é…ï¼Œç”¨ `^`
  - **å®ˆå«**ï¼Œç”¨ `when`

```elixir
x = [3, 3, -5]
y = 5

case x do
  [1, v, 5] -> IO.puts(v)
  [3, 3, ^y] -> IO.puts(y)
  [3, 3, v] when v < 0 -> IO.puts(v)
  _ -> IO.puts(0)
end
```

åœ¨ `iex` çš„äº¤äº’æ¨¡å¼ä¸‹ï¼Œä»å¥å®ˆå«çš„é”™è¯¯å¹¶ä¸ä¼šä½¿ç¨‹åºæŠ¥é”™ï¼Œè€Œæ˜¯åŒ¹é…å¤±è´¥ã€‚

```elixir
# iex çš„äº¤äº’æ¨¡å¼ä¸‹
case 1 do
  x when hd(x) -> "hd(x) ä¸è‡´ä½¿ç¨‹åºæŠ¥é”™ï¼Œè€Œæ˜¯åŒ¹é…å¤±è´¥"
  x -> "åŒ¹é…,#{x}"
end
```

### cond

éœ‘ `cond` åŒ¹é…å¤šä¸ªå€¼ï¼š

- æ¯ä¸ªä»å¥å°±æ˜¯ä¸€ä¸ªæ¡ä»¶
- é™¤äº† `false` å’Œ `nil` ä»¥å¤–ï¼Œå…¶ä»–æ‰€æœ‰å€¼éƒ½æ˜¯**çœŸå€¼**
- è¿›å…¥ç¬¬ä¸€ä¸ªä”ºçœŸå€¼çš„æ¡ä»¶åï¼Œæ•´ä¸ª `cond` ç»“æŸ
- è‡³å°‘æœ‰ä¸€ä¸ªæ¡ä»¶ä”ºçœŸå€¼ï¼Œå¦åˆ™æŠ¥é”™

```elixir
a = 1
b = -2
c = false
d = nil

r = cond do
  a + b > 0 -> "A"
  c || d -> "B"
  true -> "C"
end

# C
IO.puts(r)
```

### if å’Œ unless

éœ‘ `if` å’Œ `unless` æ˜¯**å®**ï¼Œ`unless` ä¸ `if` ç›¸åã€‚

```elixir
if 0 do
  IO.puts(:ok1)
end

if nil do
  IO.puts(:not_ok2)
else
  IO.puts(:ok2)
end

unless false do
  IO.puts(:ok3)
end

# ç»“æœ
# ok1
# ok2
# ok3
```

## å­—ç¬¦ä¸²ç›¸å…³

éœ‘ï¼š

- **ç ç‚¹**ï¼Œå­—ç¬¦åœ¨ Unicode ä¸­çš„ç´¢å¼•
  - é€šå¸¸ä»¥åå…­è¿›åˆ¶èµ‰è¡¨ç¤ºå­—ç¬¦çš„ç ç‚¹
  - å­—ç¬¦å­—é¢é‡å‰é¢åŠ  `?` è·å¾—å¯¹åº”çš„ç ç‚¹ï¼Œä»¥åè¿›åˆ¶è¡¨ç¤º
- **ç¼–ç **ï¼Œå¦‚ä½•å°†å­—ç¬¦ç ç‚¹è½¬æ¢æˆ**å­—èŠ‚**ï¼Œå¹¶å­˜å‚¨åœ¨å†…å­˜ä¸­
  - UTF-8 æ˜¯ä¸€ç§ç¼–ç ï¼Œå­—ç¬¦ç ç‚¹ä»¥ä¸€ç³»åˆ— 8 ä½å­—èŠ‚çš„å½¢å¼å­˜å‚¨
  - UTF-8 ä½¿ç”¨ 1 åˆ° 4 ä¸ªå­—èŠ‚èµ‰å­˜å‚¨å­—ç¬¦ç ç‚¹
- **å­—ç´ **ï¼Œä»¥ä¸€ä¸ªå­—ç¬¦çš„å½¢å¼å‘ˆç°ï¼Œä½†å¯èƒ½ç”±å¤šä¸ªå­—ç¬¦ç»„æˆ
- **ä½å­—ç¬¦ä¸²**ï¼Œç”±**ä½**ç»„æˆçš„è¿ç»­çš„åºåˆ—ï¼Œä»¥ `<<>>` å½¢å¼è¡¨ç¤º
  - é»˜è®¤ï¼Œä»¥ 8 ä½ï¼ˆå³ 1 å­—èŠ‚ï¼‰å­˜å‚¨ä¸€ä¸ªæ•°å­—
  - ä½¿ç”¨ `::n` æˆ– `::size(n)` æŒ‡å®šï¼Œæ¯ä¸ªæ•°å­—ä½¿ç”¨çš„ä½çš„ä¸ªæ•°
  - æ•°å­—æº¢å‡ºå¯¹åº”çš„ä½æ—¶ï¼Œä» `0` å¼€å§‹ç»§ç»­
  - ä½¿ç”¨ `<>` æ‹¼æ¥ä¸¤ä¸ªä½å­—ç¬¦ä¸²
- **binary**ï¼Œä½å­—ç¬¦ä¸²çš„å­é›†ï¼Œæ¯ä¸ªæ•°å­—çš„ä½éƒ½æ˜¯ 8 çš„å€æ•°
- **å­—ç¬¦ä¸²**ï¼Œ**binary** çš„å­é›†ï¼Œæ˜¯åˆæ³•çš„ UTF-8 ç¼–ç çš„å­—ç¬¦ç»„æˆçš„
  - å­—ç¬¦ä¸²ä¸€å®šæ˜¯ **binary**
  - **binary** ä¸ä¸€å®šæ˜¯å­—ç¬¦ä¸²

- **å­—ç¬¦åˆ—è¡¨**ï¼Œä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶æ¯ä¸ªå…ƒç´ éƒ½æ˜¯åˆæ³•çš„å­—ç¬¦ç ç‚¹ï¼Œæœ€ç»ˆå‘ˆç°çš„å­—ç¬¦ä¸²ä½¿ç”¨å•å¼•å·æ‹¬èµ·æ¥

ä¸€äº›æ–¹æ³•ï¼š

- å­—ç¬¦ä¸²ç›¸å…³ï¼š
  - `String.codepoints/1`ï¼Œå­—ç¬¦ç ç‚¹
  - `String.graphemes/1`ï¼Œè§£æä”ºå­—ç´ 
  - `String.length/1`ï¼Œå‡ ä¸ªå­—ç´ 
- è·å¾—å­—ç¬¦ä¸²å¯¹åº”çš„ä½å­—ç¬¦ä¸²ï¼š
  - `<> <<0>>`
  - `IO.inspect(item, binaries: :as_binaries)`
- åˆ¤æ–­ä½å­—ç¬¦ä¸²æˆ– **binary** è¢¤
  - `is_bitstring/1`
  - `is_binary/1`
  - `String.valid?/1`ï¼Œ**binary** å¯”åˆæ³•çš„ UTF-8 å­—ç¬¦

- å­—ç¬¦åˆ—è¡¨ç›¸å…³ï¼š
  - `is_charlist/1`
  - `to_string/1`ï¼Œè½¬æ¢ä”ºå­—ç¬¦ä¸²ï¼Œä¸ä»…é€‚ç”¨å­—ç¬¦åˆ—è¡¨ï¼Œä¹Ÿé€‚ç”¨å…¶ä»–ç±»å‹

```elixir
IO.inspect(?f)
IO.inspect(?ç )
IO.inspect("\u0066" == "f")
IO.inspect("\u7801" == "ç ")

0x0066 = 102 = ?f
0x7801 = 30721 = ?ç 

# ["ğŸ‘©", "â€", "ğŸš’"]
IO.inspect(String.codepoints("ğŸ‘©â€ğŸš’"))
# ["ğŸ‘©â€ğŸš’"]
IO.inspect(String.graphemes("ğŸ‘©â€ğŸš’"))
# 1
IO.inspect(String.length("ğŸ‘©â€ğŸš’"))

# <<104, 101, 197, 130, 197, 130, 111, 0>>
IO.inspect("heÅ‚Å‚o" <> <<0>>)
# <<104, 101, 197, 130, 197, 130, 111>>
IO.inspect("heÅ‚Å‚o", binaries: :as_binaries)

# éƒ½ä”º `true`
(<<42>> == <<42::8>>) |> IO.inspect
(<<3::4>> == <<3::size(4)>>) |> IO.inspect
(<<3::4>> == <<0::1, 0::1, 1::1, 1::1>>) |> IO.inspect
# 2^2 - 1 = 3, 5 - 3 = 2, 5 -> 0 -> 1
(<<5::2>> == <<1::2>>) |> IO.inspect

# ä¾æ¬¡ä”º `true`, `false` `true` å’Œ `true`
IO.inspect(is_bitstring(<<3::8, 5::12>>))
IO.inspect(is_binary(<<3::8, 5::12>>))
IO.inspect(is_binary(<<3::8, 5::16>>))
IO.inspect(String.valid?(<<3::8, 5::16>>))

# true
IO.inspect([?h, ?e, ?l, ?l, ?o] == 'hello')

IO.inspect(to_charlist("heÅ‚Å‚o"))
IO.inspect(to_string([104, 101, 322, 322, 111]))
```

æ¨¡å¼åŒ¹é…ä½å­—ç¬¦ä¸²ï¼š

```elixir
<<0, 1, x>> = <<0, 1, 2>>
# 2
IO.inspect(x)

<<0, 1, x::binary>> = <<0, 1, 2, 3>>
# <<2, 3>>
IO.inspect(x)

<<head::binary-size(3), rest::binary>> = <<0, 1, 2, 3>>
# <<0, 1, 2>>
IO.inspect(head)
# <<3>>
IO.inspect(rest)

<<head, rest::binary>> = "banana"
# 98
IO.inspect(head)
# "anana"
IO.inspect(rest)

<<x, _::binary>> = "Ã¼ber"
# false
IO.inspect(x == ?Ã¼)

<<x::utf8, _::binary>> = "Ã¼ber"
# true
IO.inspect(x == ?Ã¼)
```

## å…³è”æ•°æ®ç»“æ„

å…³è”æ•°æ®ç»“æ„ï¼Œå°†é”®å’Œå¯¹åº”çš„å€¼å…³è”èµ·æ¥ï¼Œç±»ä¼¼å…¶ä»–è¯­è¨€çš„å­—å…¸ã€å“ˆå¸Œã€å…³è”æ•°ç»„ç­‰ã€‚Elixir çš„å…³è”æ•°æ®ç»“æ„ä¸»è¦æœ‰**å…³é”®å­—åˆ—è¡¨**å’Œ**æ˜ å°„**ã€‚

### å…³é”®å­—åˆ—è¡¨

éœ‘ï¼š

- å…³é”®å­—åˆ—è¡¨æ˜¯åˆ—è¡¨çš„ä¸€ç§ï¼Œç”±å…ƒç»„ç»„æˆï¼Œå¹¶ä¸”å…ƒç»„åªæœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œå³é”®å’Œå€¼
- é€šå¸¸ç”¨ä½œå‡½æ•°çš„é€‰é¡¹å‚æ•°
- é”®å¿…é¡»æ˜¯åŸå­
- é”®åº”è¯¥æ˜¯æœ‰åºçš„ï¼Œç”±å¼€å‘è€…è§„å®š
- å…è®¸é‡å¤çš„é”®ï¼Œè®¿é—®å¾—åˆ°æœ€é å‰çš„é”®

```elixir
# 1. é€‰é¡¹å‚æ•°
String.split("1  2  3", " ", [trim: true])
# 1. ä½œä”ºæœ€åä¸€ä¸ªå‚æ•°æ—¶ï¼Œæº˜çœç•¥æ–¹æ‹¬å·
String.split("1  2  3", " ", trim: true)
# 2. è¿˜åŸæˆåˆ—è¡¨
equ = [{:trim, true}] == [trim: true]
# true
IO.puts(equ)
# 3. é‡å¤çš„é”®ï¼Œè®¿é—®å¾—åˆ°ç¬¬ä¸€ä¸ª
a_keywords = [{:a, 10}, {:b, false}, {:a, 20}]
# 10
IO.inspect(a_keywords[:a])
```

### æ˜ å°„

éœ‘ï¼š

- é”®æº˜æ˜¯ä»»ä½•ç±»å‹
- é”®æ²¡æœ‰é¡ºåº
- è®¿é—®ä¸å­˜åœ¨çš„é”®ï¼Œå¾—åˆ° `nil`
- æ¨¡å¼åŒ¹é…
  - æº˜åªåŒ¹é…å±€éƒ¨
  - æº˜æ— åºåŒ¹é…
  - ä¸å…è®¸åŒ¹é…ä¸å­˜åœ¨çš„é”®
- å˜é‡æº˜ï¼Œç”¨èµ‰è®¿é—®ã€ç”¨ä½œé”®ã€ç”¨åœ¨æ¨¡å¼åŒ¹é…
- æº˜ä½¿ç”¨ç‚¹ï¼ˆ`.`ï¼‰è®¿é—®åŸå­ç±»å‹çš„é”®
- å½“æ‰€æœ‰é”®éƒ½æ˜¯åŸå­æ—¶ï¼Œæº˜åƒå…³é”®å­—åˆ—è¡¨é‚£æ ·å®šä¹‰æ˜ å°„

```elixir
# 1. æ˜ å°„
mapple = %{1 => 1.01, false => :cookie, "spring" => [1, 2, 3]}
# 2. è®¿é—®æˆåŠŸ
IO.inspect(mapple["spring"])
# 2. è®¿é—®å¤±è´¥ï¼Œå¾—åˆ° `nil`
IO.inspect(mapple[:nonexist])

# 3. åŒ¹é…å±€éƒ¨ï¼Œä¸”æ— é¡ºåºè¦æ±‚
%{false => var1, 1 => var2} = mapple
# {:cookie, 1.01}
IO.inspect({var1, var2})

# 4. å˜é‡çš„åº”ç”¨
k = 1
# 4.1 ç”¨ä½œé”®
mapple = %{k => 100, 3.3 => -100}
# 4.2 è®¿é—®é”®
IO.inspect(mapple[k])
# 4.3 åŒ¹é…
# 4.3 åŒ¹é…å¤±è´¥ï¼Œå› ä¸º `k => 100`
# %{^k => 200, 3.3 => -100} = mapple

# 5. ä½¿ç”¨ `.` è®¿é—®åŸå­é”®
mapple = %{:blade => true, 1 => 2.0, "2" => 10}
IO.inspect(mapple.blade)

# 6. åƒå…³é”®å­—åˆ—è¡¨é‚£æ ·å®šä¹‰æ˜ å°„
mapple = %{a: 10, b: false}
IO.inspect(mapple)
```

ä¸€äº›æ–¹æ³•ï¼š

```elixir
# 1. å¾—åˆ°ã€å¢åŠ é”®
mapple = %{:a => 10, 2 => false}

mapple
|> Map.get(:a)
|> IO.inspect()

mapple
|> Map.put("new_key", :cookie)
|> IO.inspect()

# 2. æ›´æ–°è¯­æ³•
# %{2 => true, :a => 10}
IO.inspect(%{mapple | 2 => true})
```
